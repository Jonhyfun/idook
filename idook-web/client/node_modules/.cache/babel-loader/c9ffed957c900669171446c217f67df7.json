{"ast":null,"code":"import _classCallCheck from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import{editUser as _editUser}from'../../store/actions/authActions';import M from\"materialize-css\";import{storage}from'../../config/fbConfig';export var ImageUpload=/*#__PURE__*/function(_Component){_inherits(ImageUpload,_Component);var _super=_createSuper(ImageUpload);function ImageUpload(props){var _this;_classCallCheck(this,ImageUpload);_this=_super.call(this,props);_this.handleEdit=function(e){e.preventDefault();var auth=_this.props.auth;//console.log(url);\n// console.log(sids);\n// this.setState({image: 'false'})\n_this.state.image='false';_this.props.editUser(_this.state,auth.uid);//console.log(key)\n//this.props.editId(ids, key)\n//this.props.history.push('/');\n};_this.handleChange=function(e){if(e.target.files[0]){var image=e.target.files[0];_this.setState(function(){return{image:image};});}};_this.handleUpload=function(){var image=_this.state.image;var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on('state_changed',function(snapshot){// progrss function ....\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);_this.setState({progress:progress});},function(error){// error function ....\nM.toast({html:'Erro: tente novamente mais tarde',classes:'rounded'});//  console.log(error);\n},function(){// complete function ....\nstorage.ref('images').child(image.name).getDownloadURL().then(function(url){M.toast({html:'Foto carregada',classes:'rounded'});//console.log(url);\n_this.setState({url:url});});});};_this.state={image:null,url:'',progress:0};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));return _this;}_createClass(ImageUpload,[{key:\"render\",value:function render(){var _this2=this;var profile=this.props.profile;//console.log(profile)\nreturn/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{alt:\"perfil\",src:this.state.url||profile.url,\"object-fit\":\"cover\",class:\"circular--portraitM\"}),/*#__PURE__*/React.createElement(\"progress\",{value:this.state.progress,max:\"100\"}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{style:{display:'none'},type:\"file\",onChange:this.handleChange,ref:function ref(image){return _this2.image=image;}}),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:function onClick(){return _this2.image.click();}},\"Selecionar\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:this.handleUpload},\"Enviar\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:this.handleEdit},\"Salvar\"),/*#__PURE__*/React.createElement(\"br\",null));}}]);return ImageUpload;}(Component);var mapStateToProps=function mapStateToProps(state){return{authError:state.auth.authError,auth:state.firebase.auth,profile:state.firebase.profile};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{editUser:function editUser(ids,id){return dispatch(_editUser(ids,id));}};};export default connect(mapStateToProps,mapDispatchToProps)(ImageUpload);","map":{"version":3,"sources":["/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/src/components/personalization/ImageUpload.js"],"names":["React","Component","connect","editUser","M","storage","ImageUpload","props","handleEdit","e","preventDefault","auth","state","image","uid","handleChange","target","files","setState","handleUpload","uploadTask","ref","name","put","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","error","toast","html","classes","child","getDownloadURL","then","url","bind","profile","display","click","mapStateToProps","authError","firebase","mapDispatchToProps","dispatch","ids","id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { editUser } from '../../store/actions/authActions'\nimport M from \"materialize-css\";\n\nimport {storage} from '../../config/fbConfig';\n\n\nexport class ImageUpload extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      image: null,\n      url: '',\n      progress: 0\n    }\n    this.handleChange = this\n      .handleChange\n      .bind(this);\n      this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  handleEdit = (e) => {\n    e.preventDefault();\n    const { auth } = this.props;\n\n    //console.log(url);\n\n   // console.log(sids);\n\n  // this.setState({image: 'false'})\n\n    this.state.image = 'false';\n\n    this.props.editUser(this.state, auth.uid)\n\n    //console.log(key)\n\n    //this.props.editId(ids, key)\n    //this.props.history.push('/');\n}\n\n  handleChange = e => {\n    if (e.target.files[0]) {\n      const image = e.target.files[0];\n      this.setState(() => ({image}));\n    }\n  }\n  handleUpload = () => {\n      const {image} = this.state;\n      const uploadTask = storage.ref(`images/${image.name}`).put(image);\n      uploadTask.on('state_changed', \n      (snapshot) => {\n        // progrss function ....\n        const progress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n        this.setState({progress});\n      }, \n      (error) => {\n           // error function ....\n           M.toast({html: 'Erro: tente novamente mais tarde', classes: 'rounded'});\n      //  console.log(error);\n      }, \n    () => {\n        // complete function ....\n        storage.ref('images').child(image.name).getDownloadURL().then(url => {\n          M.toast({html: 'Foto carregada', classes: 'rounded'});\n            //console.log(url);\n            this.setState({url});\n        })\n    });\n    \n  }\n  render() {\n\n    const {profile} = this.props\n\n    //console.log(profile)\n\n    return (\n      <div>\n          <img alt=\"perfil\" src={this.state.url || profile.url} object-fit='cover' class=\"circular--portraitM\" />\n      <progress value={this.state.progress} max=\"100\"/>\n      <br/>\n        <input \n        style={{display: 'none'}} \n        type=\"file\" \n        onChange={this.handleChange}\n        ref={image => this.image = image}/>\n        <button className=\"btn z-depth-0\" onClick={() => this.image.click()}>Selecionar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleUpload}>Enviar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleEdit}>Salvar</button>\n        <br/>\n        \n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n      authError: state.auth.authError,\n      auth: state.firebase.auth,\n      profile: state.firebase.profile,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n      editUser: (ids,id) => dispatch(editUser(ids,id))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ImageUpload)"]},"metadata":{},"sourceType":"module"}