{"ast":null,"code":"import _classCallCheck from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import{editId as _editId}from'../../store/actions/idActions';import{compose}from'redux';import{firestoreConnect}from'react-redux-firebase';import M from\"materialize-css\";import{storage}from'../../config/fbConfig';export var ImageUpload=/*#__PURE__*/function(_Component){_inherits(ImageUpload,_Component);var _super=_createSuper(ImageUpload);function ImageUpload(props){var _this;_classCallCheck(this,ImageUpload);_this=_super.call(this,props);_this.handleEdit=function(e){e.preventDefault();var sids=_this.props.sids;//console.log(url);\n// console.log(sids);\n_this.state.image='false';//   this.setState({image: 'false'})\nvar ids=_this.state;var key=sids.id;//console.log(key)\n_this.props.editId(ids,key);//this.props.history.push('/');\n};_this.handleChange=function(e){if(e.target.files[0]){var image=e.target.files[0];_this.setState(function(){return{image:image};});}};_this.handleUpload=function(){var image=_this.state.image;if(image){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on('state_changed',function(snapshot){// progrss function ....\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);_this.setState({progress:progress});},function(error){// error function ....\nM.toast({html:'Erro: tente novamente mais tarde',classes:'rounded'});// console.log(error);\n},function(){// complete function ....\nstorage.ref('images').child(image.name).getDownloadURL().then(function(url){//console.log(url);\nM.toast({html:'Foto carregada',classes:'rounded'});_this.setState({url:url});});});}else{M.toast({html:'Erro: nenhuma imagem selecionada',classes:'rounded'});}};_this.state={image:null,url:'',progress:0};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));return _this;}_createClass(ImageUpload,[{key:\"render\",value:function render(){var _this2=this;var vids=this.props.vids;//console.log(sids.url)\nreturn/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{alt:\"Foto de perfil\",src:this.state.url||vids.url,\"object-fit\":\"cover\",class:\"circular--portraitM\"}),/*#__PURE__*/React.createElement(\"progress\",{value:this.state.progress,max:\"100\"}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{style:{display:'none'},type:\"file\",onChange:this.handleChange,ref:function ref(image){return _this2.image=image;}}),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:function onClick(){return _this2.image.click();}},\"Selecionar\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:this.handleUpload},\"Enviar\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn z-depth-0\",onClick:this.handleEdit},\"Salvar\"),/*#__PURE__*/React.createElement(\"br\",null));}}]);return ImageUpload;}(Component);var mapStateToProps=function mapStateToProps(state,sids,id){//console.log(state);\n//console.log(sids)\n//const id = ownProps.match.params.id;\nvar ids=state.firestore.data.ids;var vids=ids[sids.id];//console.log(vids)\n//const sids = ids ? ids[id] : null\nreturn{//id:id,\nsids:sids,vids:vids//auth: state.firebase.auth\n};};var mapDistpacthToProps=function mapDistpacthToProps(dispatch){return{editId:function editId(ids,id){return dispatch(_editId(ids,id));}};};export default compose(connect(mapStateToProps,mapDistpacthToProps),firestoreConnect([{collection:'ids'}]))(ImageUpload);","map":{"version":3,"sources":["/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/src/components/ids/ImageUpload.js"],"names":["React","Component","connect","editId","compose","firestoreConnect","M","storage","ImageUpload","props","handleEdit","e","preventDefault","sids","state","image","ids","key","id","handleChange","target","files","setState","handleUpload","uploadTask","ref","name","put","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","error","toast","html","classes","child","getDownloadURL","then","url","bind","vids","display","click","mapStateToProps","firestore","data","mapDistpacthToProps","dispatch","collection"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { editId } from '../../store/actions/idActions'\nimport { compose } from 'redux';\nimport {  firestoreConnect } from 'react-redux-firebase';\nimport M from \"materialize-css\";\n\nimport {storage} from '../../config/fbConfig';\n\n\nexport class ImageUpload extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      image: null,\n      url: '',\n      progress: 0\n    }\n    this.handleChange = this\n      .handleChange\n      .bind(this);\n      this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  handleEdit = (e) => {\n    e.preventDefault();\n    const { sids } = this.props;\n  \n\n    //console.log(url);\n\n   // console.log(sids);\n\n  this.state.image = 'false';\n\n //   this.setState({image: 'false'})\n\n    const ids = this.state;\n\n    const key = sids.id;\n\n    //console.log(key)\n    this.props.editId(ids, key)\n    //this.props.history.push('/');\n}\n\n  handleChange = e => {\n    if (e.target.files[0]) {\n      const image = e.target.files[0];\n      this.setState(() => ({image}));\n    }\n  }\n  handleUpload = () => {\n      const {image} = this.state;\n      if(image){\n\n        const uploadTask = storage.ref(`images/${image.name}`).put(image);\n        uploadTask.on('state_changed', \n        (snapshot) => {\n          // progrss function ....\n          const progress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n          this.setState({progress});\n        }, \n        (error) => {\n             // error function ....\n             M.toast({html: 'Erro: tente novamente mais tarde', classes: 'rounded'});\n         // console.log(error);\n        }, \n      () => {\n          // complete function ....\n          storage.ref('images').child(image.name).getDownloadURL().then(url => {\n              //console.log(url);\n              M.toast({html: 'Foto carregada', classes: 'rounded'});\n  \n              this.setState({url});\n          })\n      });\n\n      }\n\n      else{\n        M.toast({html: 'Erro: nenhuma imagem selecionada', classes: 'rounded'});\n      }\n    \n    \n  }\n  render() {\n\n    const {vids} = this.props\n\n    //console.log(sids.url)\n\n    return (\n      <div>\n          <img alt=\"Foto de perfil\" src={this.state.url || vids.url} object-fit='cover' class=\"circular--portraitM\" />\n      <progress value={this.state.progress} max=\"100\"/>\n      <br/>\n        <input \n        style={{display: 'none'}} \n        type=\"file\" \n        onChange={this.handleChange}\n        ref={image => this.image = image}/>\n        <button className=\"btn z-depth-0\" onClick={() => this.image.click()}>Selecionar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleUpload}>Enviar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleEdit}>Salvar</button>\n        <br/>\n        \n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state, sids, id) => {\n    //console.log(state);\n    //console.log(sids)\n    //const id = ownProps.match.params.id;\n    const ids = state.firestore.data.ids;\n    const vids = ids[sids.id]\n    //console.log(vids)\n    //const sids = ids ? ids[id] : null\n    return {\n        //id:id,\n        sids: sids,\n        vids: vids,\n        //auth: state.firebase.auth\n    }\n}\n\nconst mapDistpacthToProps = (dispatch) => {\n    return {\n        editId: (ids, id) => dispatch(editId(ids, id)),\n    }\n}\n\nexport default compose(\n    connect(mapStateToProps, mapDistpacthToProps),\n    firestoreConnect([\n        { collection: 'ids' }\n    ])\n)(ImageUpload)"]},"metadata":{},"sourceType":"module"}