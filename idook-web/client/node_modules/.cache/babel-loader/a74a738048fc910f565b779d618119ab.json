{"ast":null,"code":"var _jsxFileName = \"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/src/components/personalization/ImageUpload.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { editUser } from '../../store/actions/authActions';\nimport M from \"materialize-css\";\nimport { storage } from '../../config/fbConfig';\nexport class ImageUpload extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleEdit = e => {\n      e.preventDefault();\n      const {\n        auth\n      } = this.props; //console.log(url);\n      // console.log(sids);\n      // this.setState({image: 'false'})\n\n      this.state.image = 'false';\n      this.props.editUser(this.state, auth.uid); //console.log(key)\n      //this.props.editId(ids, key)\n      //this.props.history.push('/');\n    };\n\n    this.handleChange = e => {\n      if (e.target.files[0]) {\n        const image = e.target.files[0];\n        this.setState(() => ({\n          image\n        }));\n      }\n    };\n\n    this.handleUpload = () => {\n      const {\n        image\n      } = this.state;\n      const uploadTask = storage.ref(`images/${image.name}`).put(image);\n      uploadTask.on('state_changed', snapshot => {\n        // progrss function ....\n        const progress = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n        this.setState({\n          progress\n        });\n      }, error => {\n        // error function ....\n        M.toast({\n          html: 'Erro: tente novamente mais tarde',\n          classes: 'rounded'\n        }); //  console.log(error);\n      }, () => {\n        // complete function ....\n        storage.ref('images').child(image.name).getDownloadURL().then(url => {\n          M.toast({\n            html: 'Foto carregada',\n            classes: 'rounded'\n          }); //console.log(url);\n\n          this.setState({\n            url\n          });\n        });\n      });\n    };\n\n    this.state = {\n      image: null,\n      url: '',\n      progress: 0\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  render() {\n    const {\n      profile\n    } = this.props; //console.log(profile)\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      alt: \"perfil\",\n      src: this.state.url || profile.url,\n      \"object-fit\": \"cover\",\n      class: \"circular--portraitM\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"progress\", {\n      value: this.state.progress,\n      max: \"100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      style: {\n        display: 'none'\n      },\n      type: \"file\",\n      onChange: this.handleChange,\n      ref: image => this.image = image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn z-depth-0\",\n      onClick: () => this.image.click(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, \"Selecionar\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn z-depth-0\",\n      onClick: this.handleUpload,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }\n    }, \"Enviar\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn z-depth-0\",\n      onClick: this.handleEdit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }\n    }, \"Salvar\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    authError: state.auth.authError,\n    auth: state.firebase.auth,\n    profile: state.firebase.profile\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    editUser: (ids, id) => dispatch(editUser(ids, id))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ImageUpload);","map":{"version":3,"sources":["/home/thabataganga/Documentos/GITHUB/idook/idook/idook-web/client/src/components/personalization/ImageUpload.js"],"names":["React","Component","connect","editUser","M","storage","ImageUpload","constructor","props","handleEdit","e","preventDefault","auth","state","image","uid","handleChange","target","files","setState","handleUpload","uploadTask","ref","name","put","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","error","toast","html","classes","child","getDownloadURL","then","url","bind","render","profile","display","click","mapStateToProps","authError","firebase","mapDispatchToProps","dispatch","ids","id"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,QAAT,QAAyB,iCAAzB;AACA,OAAOC,CAAP,MAAc,iBAAd;AAEA,SAAQC,OAAR,QAAsB,uBAAtB;AAGA,OAAO,MAAMC,WAAN,SAA0BL,SAA1B,CAAoC;AACzCM,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAanBC,UAbmB,GAaLC,CAAD,IAAO;AAClBA,MAAAA,CAAC,CAACC,cAAF;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,KAAKJ,KAAtB,CAFkB,CAIlB;AAED;AAED;;AAEE,WAAKK,KAAL,CAAWC,KAAX,GAAmB,OAAnB;AAEA,WAAKN,KAAL,CAAWL,QAAX,CAAoB,KAAKU,KAAzB,EAAgCD,IAAI,CAACG,GAArC,EAZkB,CAclB;AAEA;AACA;AACH,KA/BoB;;AAAA,SAiCnBC,YAjCmB,GAiCJN,CAAC,IAAI;AAClB,UAAIA,CAAC,CAACO,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,EAAuB;AACrB,cAAMJ,KAAK,GAAGJ,CAAC,CAACO,MAAF,CAASC,KAAT,CAAe,CAAf,CAAd;AACA,aAAKC,QAAL,CAAc,OAAO;AAACL,UAAAA;AAAD,SAAP,CAAd;AACD;AACF,KAtCkB;;AAAA,SAuCnBM,YAvCmB,GAuCJ,MAAM;AACjB,YAAM;AAACN,QAAAA;AAAD,UAAU,KAAKD,KAArB;AACA,YAAMQ,UAAU,GAAGhB,OAAO,CAACiB,GAAR,CAAa,UAASR,KAAK,CAACS,IAAK,EAAjC,EAAoCC,GAApC,CAAwCV,KAAxC,CAAnB;AACAO,MAAAA,UAAU,CAACI,EAAX,CAAc,eAAd,EACCC,QAAD,IAAc;AACZ;AACA,cAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAYH,QAAQ,CAACI,gBAAT,GAA4BJ,QAAQ,CAACK,UAAtC,GAAoD,GAA/D,CAAjB;AACA,aAAKZ,QAAL,CAAc;AAACQ,UAAAA;AAAD,SAAd;AACD,OALD,EAMCK,KAAD,IAAW;AACN;AACA5B,QAAAA,CAAC,CAAC6B,KAAF,CAAQ;AAACC,UAAAA,IAAI,EAAE,kCAAP;AAA2CC,UAAAA,OAAO,EAAE;AAApD,SAAR,EAFM,CAGX;AACC,OAVD,EAWF,MAAM;AACF;AACA9B,QAAAA,OAAO,CAACiB,GAAR,CAAY,QAAZ,EAAsBc,KAAtB,CAA4BtB,KAAK,CAACS,IAAlC,EAAwCc,cAAxC,GAAyDC,IAAzD,CAA8DC,GAAG,IAAI;AACnEnC,UAAAA,CAAC,CAAC6B,KAAF,CAAQ;AAACC,YAAAA,IAAI,EAAE,gBAAP;AAAyBC,YAAAA,OAAO,EAAE;AAAlC,WAAR,EADmE,CAEjE;;AACA,eAAKhB,QAAL,CAAc;AAACoB,YAAAA;AAAD,WAAd;AACH,SAJD;AAKH,OAlBC;AAoBH,KA9DkB;;AAEjB,SAAK1B,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,IADI;AAEXyB,MAAAA,GAAG,EAAE,EAFM;AAGXZ,MAAAA,QAAQ,EAAE;AAHC,KAAb;AAKA,SAAKX,YAAL,GAAoB,KACjBA,YADiB,CAEjBwB,IAFiB,CAEZ,IAFY,CAApB;AAGE,SAAKpB,YAAL,GAAoB,KAAKA,YAAL,CAAkBoB,IAAlB,CAAuB,IAAvB,CAApB;AACH;;AAoDDC,EAAAA,MAAM,GAAG;AAEP,UAAM;AAACC,MAAAA;AAAD,QAAY,KAAKlC,KAAvB,CAFO,CAIP;;AAEA,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,GAAG,EAAC,QAAT;AAAkB,MAAA,GAAG,EAAE,KAAKK,KAAL,CAAW0B,GAAX,IAAkBG,OAAO,CAACH,GAAjD;AAAsD,oBAAW,OAAjE;AAAyE,MAAA,KAAK,EAAC,qBAA/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAEA;AAAU,MAAA,KAAK,EAAE,KAAK1B,KAAL,CAAWc,QAA5B;AAAsC,MAAA,GAAG,EAAC,KAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFA,eAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHA,eAIE;AACA,MAAA,KAAK,EAAE;AAACgB,QAAAA,OAAO,EAAE;AAAV,OADP;AAEA,MAAA,IAAI,EAAC,MAFL;AAGA,MAAA,QAAQ,EAAE,KAAK3B,YAHf;AAIA,MAAA,GAAG,EAAEF,KAAK,IAAI,KAAKA,KAAL,GAAaA,KAJ3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,eASE;AAAQ,MAAA,SAAS,EAAC,eAAlB;AAAkC,MAAA,OAAO,EAAE,MAAM,KAAKA,KAAL,CAAW8B,KAAX,EAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBATF,eAUE;AAAQ,MAAA,SAAS,EAAC,eAAlB;AAAkC,MAAA,OAAO,EAAE,KAAKxB,YAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF,eAWE;AAAQ,MAAA,SAAS,EAAC,eAAlB;AAAkC,MAAA,OAAO,EAAE,KAAKX,UAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAXF,eAYE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZF,CADF;AAiBD;;AAvFwC;;AA0F3C,MAAMoC,eAAe,GAAIhC,KAAD,IAAW;AACjC,SAAO;AACHiC,IAAAA,SAAS,EAAEjC,KAAK,CAACD,IAAN,CAAWkC,SADnB;AAEHlC,IAAAA,IAAI,EAAEC,KAAK,CAACkC,QAAN,CAAenC,IAFlB;AAGH8B,IAAAA,OAAO,EAAE7B,KAAK,CAACkC,QAAN,CAAeL;AAHrB,GAAP;AAKD,CAND;;AAQA,MAAMM,kBAAkB,GAAIC,QAAD,IAAc;AACvC,SAAO;AACH9C,IAAAA,QAAQ,EAAE,CAAC+C,GAAD,EAAKC,EAAL,KAAYF,QAAQ,CAAC9C,QAAQ,CAAC+C,GAAD,EAAKC,EAAL,CAAT;AAD3B,GAAP;AAGD,CAJD;;AAMA,eAAejD,OAAO,CAAC2C,eAAD,EAAkBG,kBAAlB,CAAP,CAA6C1C,WAA7C,CAAf","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { editUser } from '../../store/actions/authActions'\nimport M from \"materialize-css\";\n\nimport {storage} from '../../config/fbConfig';\n\n\nexport class ImageUpload extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      image: null,\n      url: '',\n      progress: 0\n    }\n    this.handleChange = this\n      .handleChange\n      .bind(this);\n      this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  handleEdit = (e) => {\n    e.preventDefault();\n    const { auth } = this.props;\n\n    //console.log(url);\n\n   // console.log(sids);\n\n  // this.setState({image: 'false'})\n\n    this.state.image = 'false';\n\n    this.props.editUser(this.state, auth.uid)\n\n    //console.log(key)\n\n    //this.props.editId(ids, key)\n    //this.props.history.push('/');\n}\n\n  handleChange = e => {\n    if (e.target.files[0]) {\n      const image = e.target.files[0];\n      this.setState(() => ({image}));\n    }\n  }\n  handleUpload = () => {\n      const {image} = this.state;\n      const uploadTask = storage.ref(`images/${image.name}`).put(image);\n      uploadTask.on('state_changed', \n      (snapshot) => {\n        // progrss function ....\n        const progress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n        this.setState({progress});\n      }, \n      (error) => {\n           // error function ....\n           M.toast({html: 'Erro: tente novamente mais tarde', classes: 'rounded'});\n      //  console.log(error);\n      }, \n    () => {\n        // complete function ....\n        storage.ref('images').child(image.name).getDownloadURL().then(url => {\n          M.toast({html: 'Foto carregada', classes: 'rounded'});\n            //console.log(url);\n            this.setState({url});\n        })\n    });\n    \n  }\n  render() {\n\n    const {profile} = this.props\n\n    //console.log(profile)\n\n    return (\n      <div>\n          <img alt=\"perfil\" src={this.state.url || profile.url} object-fit='cover' class=\"circular--portraitM\" />\n      <progress value={this.state.progress} max=\"100\"/>\n      <br/>\n        <input \n        style={{display: 'none'}} \n        type=\"file\" \n        onChange={this.handleChange}\n        ref={image => this.image = image}/>\n        <button className=\"btn z-depth-0\" onClick={() => this.image.click()}>Selecionar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleUpload}>Enviar</button>\n        <button className=\"btn z-depth-0\" onClick={this.handleEdit}>Salvar</button>\n        <br/>\n        \n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n      authError: state.auth.authError,\n      auth: state.firebase.auth,\n      profile: state.firebase.profile,\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n      editUser: (ids,id) => dispatch(editUser(ids,id))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ImageUpload)"]},"metadata":{},"sourceType":"module"}