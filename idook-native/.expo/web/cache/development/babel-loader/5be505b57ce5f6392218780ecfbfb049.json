{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/thabataganga/Documentos/GITHUB/idook/idook/idook-native/src/pages/id/uploadphoto/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport * as firebase from \"firebase\";\nimport * as ImagePicker from 'expo-image-picker';\nimport Constants from 'expo-constants';\nimport * as Permissions from 'expo-permissions';\nimport { Feather } from '@expo/vector-icons';\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport logoImg from \"../../../assets/idook.png\";\nimport logoCliente from \"../../../assets/sindpd.png\";\nimport styles from \"./styles\";\nimport { editId as _editId } from \"../../../store/actions/idActions\";\n\nvar EditID = function (_React$Component) {\n  _inherits(EditID, _React$Component);\n\n  var _super = _createSuper(EditID);\n\n  function EditID(props) {\n    var _this;\n\n    _classCallCheck(this, EditID);\n\n    _this = _super.call(this, props);\n\n    _this.getPermissionAsync = function _callee() {\n      var _await$Permissions$as, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!Constants.platform.ios) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n            case 3:\n              _await$Permissions$as = _context.sent;\n              status = _await$Permissions$as.status;\n\n              if (status !== 'granted') {\n                alert('Sorry, we need camera roll permissions to make this work!');\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this._pickImage = function _callee2() {\n      var result;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\n                allowsEditing: true,\n                aspect: [4, 4],\n                quality: 1\n              }));\n\n            case 3:\n              result = _context2.sent;\n\n              if (!result.cancelled) {\n                _this.setState({\n                  image: result.uri\n                });\n              }\n\n              console.log(result);\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[0, 8]], Promise);\n    };\n\n    _this.handleChange = function (e) {\n      _this.setState(_defineProperty({}, e.target.id, e.target.value));\n    };\n\n    _this.handleEditIm = function (e) {\n      e.preventDefault();\n      var _this$props = _this.props,\n          auth = _this$props.auth,\n          profile = _this$props.profile,\n          ids = _this$props.ids;\n      var token = profile.token;\n      _this.state.image = 'false';\n      var idss = _this.state;\n      var filterToken = ids.filter(function (id) {\n        return id.id === token;\n      });\n\n      _this.props.editId(idss, token);\n    };\n\n    _this.uploadImage = function _callee3(uri, imageName) {\n      var response, blob, ref;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(fetch(uri));\n\n            case 2:\n              response = _context3.sent;\n              _context3.next = 5;\n              return _regeneratorRuntime.awrap(response.blob());\n\n            case 5:\n              blob = _context3.sent;\n              ref = firebase.storage().ref().child(\"images/\" + imageName);\n              ref.getDownloadURL().then(function (url) {\n                _this.setState(function () {\n                  return {\n                    url: url\n                  };\n                });\n              });\n              return _context3.abrupt(\"return\", ref.put(blob));\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      url: '',\n      image: ''\n    };\n    _this.pickImage = _this.pickImage.bind(_assertThisInitialized(_this));\n    _this.uploadImage = _this.uploadImage.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(EditID, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getPermissionAsync();\n    }\n  }, {\n    key: \"useEffect\",\n    value: function useEffect() {\n      var _await$ImagePicker$re, status;\n\n      return _regeneratorRuntime.async(function useEffect$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!Constants.platform.ios) {\n                _context4.next = 6;\n                break;\n              }\n\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(ImagePicker.requestCameraRollPermissionsAsync());\n\n            case 3:\n              _await$ImagePicker$re = _context4.sent;\n              status = _await$ImagePicker$re.status;\n\n              if (status !== 'granted') {\n                alert('Sorry, we need camera roll permissions to make this work!');\n              }\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }, {\n    key: \"signOutUser\",\n    value: function signOutUser() {\n      firebase.auth().signOut();\n    }\n  }, {\n    key: \"pickImage\",\n    value: function pickImage() {\n      var result, image;\n      return _regeneratorRuntime.async(function pickImage$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\n                allowsEditing: true,\n                aspect: [4, 3],\n                quality: 1\n              }));\n\n            case 2:\n              result = _context5.sent;\n\n              if (!result.cancelled) {\n                image = result.uri;\n                this.setState(function () {\n                  return {\n                    image: image\n                  };\n                });\n                this.uploadImage(image, this.props.profile.cpf);\n              }\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          auth = _this$props2.auth,\n          profile = _this$props2.profile,\n          ids = _this$props2.ids;\n      var token = profile.token;\n      var filterToken = ids.filter(function (id) {\n        return id.id === token;\n      });\n      return React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: styles.header,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 17\n        }\n      }, React.createElement(Image, {\n        style: styles.logo,\n        source: logoCliente,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }\n      }), React.createElement(TouchableOpacity, {\n        style: styles.headerText,\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate(\"Settings\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }\n      }, React.createElement(Feather, {\n        name: \"arrow-left\",\n        size: 20,\n        color: \"#91bd36\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 25\n        }\n      }))), React.createElement(View, {\n        style: {\n          alignItems: 'flex-start'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: styles.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 21\n        }\n      }, \"Foto\"), React.createElement(Text, {\n        style: styles.description,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }\n      }, \"Configure a foto do seu IDook\")), React.createElement(View, {\n        style: {\n          justifyContent: 'space-between',\n          marginVertical: 50,\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 17\n        }\n      }, React.createElement(Image, {\n        source: {\n          uri: this.state.image || filterToken[0].url\n        },\n        style: {\n          width: 200,\n          height: 200\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 17\n        }\n      })), React.createElement(View, {\n        style: {\n          marginTop: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 17\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: this._pickImage,\n        style: styles.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: \"#FFF\",\n          fontWeight: \"500\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }\n      }, \"Selecionar\"))), React.createElement(View, {\n        style: {\n          marginTop: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 17\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: this.handleEditIm,\n        style: styles.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: \"#FFF\",\n          fontWeight: \"500\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 21\n        }\n      }, \"Salvar\"))));\n    }\n  }]);\n\n  return EditID;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    auth: state.firebase.auth,\n    profile: state.firebase.profile,\n    ids: state.firestore.ordered.ids\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    editId: function editId(ids, id) {\n      return dispatch(_editId(ids, id));\n    }\n  };\n};\n\nexport default compose(connect(mapStateToProps, mapDispatchToProps), firestoreConnect([{\n  collection: 'ids'\n}]))(EditID);","map":{"version":3,"sources":["/home/thabataganga/Documentos/GITHUB/idook/idook/idook-native/src/pages/id/uploadphoto/index.js"],"names":["React","firebase","ImagePicker","Constants","Permissions","Feather","firestoreConnect","connect","compose","logoImg","logoCliente","styles","editId","EditID","props","getPermissionAsync","platform","ios","askAsync","CAMERA_ROLL","status","alert","_pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","result","cancelled","setState","image","uri","console","log","handleChange","e","target","id","value","handleEditIm","preventDefault","auth","profile","ids","token","state","idss","filterToken","filter","uploadImage","imageName","fetch","response","blob","ref","storage","child","getDownloadURL","then","url","put","pickImage","bind","requestCameraRollPermissionsAsync","signOut","cpf","container","header","logo","headerText","navigation","navigate","alignItems","title","description","justifyContent","marginVertical","width","height","marginTop","button","color","fontWeight","Component","mapStateToProps","firestore","ordered","mapDispatchToProps","dispatch","collection"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { View, Text,  Image, TouchableOpacity } from \"react-native\";\nimport * as firebase from \"firebase\";\n\nimport * as ImagePicker from 'expo-image-picker';\nimport Constants from 'expo-constants';\nimport * as Permissions from 'expo-permissions';\n\n\nimport { Feather } from '@expo/vector-icons';\n\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\n\nimport logoImg from '../../../assets/idook.png';\nimport logoCliente from '../../../assets/sindpd.png';\nimport styles from './styles';\n\nimport { editId } from '../../../store/actions/idActions'\n\n\nclass EditID extends React.Component {\n\n    constructor(props) {\n        super(props);\n            this.state = {\n                url: '',\n                image: '',\n                \n            \n            }\n            this.pickImage = this\n            .pickImage\n            .bind(this);\n\n            this.uploadImage = this\n            .uploadImage\n            .bind(this);\n           \n        }\n\n        componentDidMount() {\n            this.getPermissionAsync();\n          }\n        \n          getPermissionAsync = async () => {\n            if (Constants.platform.ios) {\n              const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n              if (status !== 'granted') {\n                alert('Sorry, we need camera roll permissions to make this work!');\n              }\n            }\n          };\n        \n          _pickImage = async () => {\n            try {\n              let result = await ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\n                allowsEditing: true,\n                aspect: [4, 4],\n                quality: 1,\n              });\n              if (!result.cancelled) {\n                this.setState({ image: result.uri });\n              }\n        \n              console.log(result);\n            } catch (E) {\n              console.log(E);\n            }\n          };\n\n    \n\n    async useEffect(){\n\n        if (Constants.platform.ios) {\n            const { status } = await ImagePicker.requestCameraRollPermissionsAsync();\n            if (status !== 'granted') {\n              alert('Sorry, we need camera roll permissions to make this work!');\n            }\n          }\n\n    }\n\n\n\n    signOutUser() {\n        firebase.auth().signOut();\n    };\n\n    handleChange = (e) => {\n        this.setState({\n            [e.target.id]:e.target.value\n        })\n    };\n\n    handleEditIm = (e) => {\n        e.preventDefault();\n        const {auth, profile, ids} = this.props\n        const token = profile.token\n\n        this.state.image = 'false';\n\n        //const {url} = this.state.url\n        //console.log(url) \n\n        const idss = this.state;\n\n        const filterToken = ids.filter(id => id.id === token);\n\n        this.props.editId(idss, token)\n\n       // this.props.navigation.navigate(\"Detail\");\n        //this.props.history.push('/');\n        //console.log(this.state);\n    };\n\n    async pickImage(){\n\n        let result = await ImagePicker.launchImageLibraryAsync({\n            mediaTypes: ImagePicker.MediaTypeOptions.All,\n            allowsEditing: true,\n            aspect: [4, 3],\n            quality: 1,\n          });\n      \n          //console.log(this.props.profile.cpf)\n      \n          if (!result.cancelled) {\n            const image = result.uri \n            this.setState(() => ({image}))\n\n            this.uploadImage(image, this.props.profile.cpf)\n\n            //console.log(this.state)\n            //this.state.setImage = result.uri\n           // this.state.setImage(result.uri);\n          }\n\n    }\n\n    uploadImage = async (uri, imageName) => {\n        const response = await fetch(uri);\n        const blob = await response.blob();\n    \n        var ref = firebase.storage().ref().child(\"images/\" + imageName);\n        ref.getDownloadURL().then((url) => {\n           // console.log(url)\n            this.setState(() => ({url}))\n            //  console.log(this.state.url)\n            \n        })        \n       // this.setState(() => ({url}))\n\n        //console.log(this.state.url)\n        return ref.put(blob);\n      }\n\n      \n\n\n\n    render() {\n\n        const {auth, profile, ids} = this.props\n        const token = profile.token\n       // const setImage = this.state\n\n        const filterToken = ids.filter(id => id.id === token);\n        //console.log(this.state.url)\n\n        return (\n            <View style={styles.container}>\n                <View style={styles.header}>\n                    <Image style={styles.logo} source={logoCliente} />\n\n                    <TouchableOpacity style={styles.headerText} onPress={() => this.props.navigation.navigate(\"Settings\")}>\n                        <Feather name=\"arrow-left\" size={20} color=\"#91bd36\"\n                        />\n                    </TouchableOpacity>\n                </View>\n\n\n                <View style={{ alignItems: 'flex-start' }}>\n                    <Text style={styles.title}>Foto</Text>\n                    <Text style={styles.description}>Configure a foto do seu IDook</Text>\n                </View>\n\n                <View style={{ justifyContent: 'space-between', marginVertical:50, alignItems: 'center', justifyContent: 'center' }}>\n               \n                <Image source={{uri: this.state.image || filterToken[0].url}} style={{ width: 200, height: 200 }} />\n                </View>\n\n                <View style={{marginTop: 20}}>\n                <TouchableOpacity onPress={this._pickImage}   style={styles.button}>\n                    <Text style={{ color: \"#FFF\", fontWeight: \"500\" }}>Selecionar</Text>\n                </TouchableOpacity>\n                </View>\n\n                <View style={{marginTop: 10}}>\n                <TouchableOpacity onPress={this.handleEditIm}  style={styles.button}>\n                    <Text style={{ color: \"#FFF\", fontWeight: \"500\" }}>Salvar</Text>\n                </TouchableOpacity>\n                </View>\n\n            </View>\n        );\n    }\n}\n\nconst mapStateToProps = (state) => {\n\n   // console.log(state)\n    return{\n        auth: state.firebase.auth,\n        profile: state.firebase.profile,\n        ids: state.firestore.ordered.ids,\n    }\n  }\n  \n  const mapDispatchToProps = (dispatch) => {\n    return {\n        editId: (ids, id) => dispatch(editId(ids, id))\n    }\n  }\n\n  export default compose(\n    connect(mapStateToProps, mapDispatchToProps),\n    firestoreConnect([\n        { collection: 'ids' }\n    ])\n)(EditID)\n"]},"metadata":{},"sourceType":"module"}